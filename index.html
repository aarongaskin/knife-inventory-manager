<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Knife Inventory Manager v13 - With Sales Tax</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 10px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .nav-tabs {
            display: flex;
            flex-wrap: wrap;
            background: #f8f9fa;
            border-bottom: 2px solid #e0e0e0;
            overflow-x: auto;
        }

        .nav-tabs button {
            background: none;
            border: none;
            padding: 15px 20px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            color: #666;
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
            white-space: nowrap;
        }

        .nav-tabs button:hover {
            background: #e8e8e8;
            color: #667eea;
        }

        .nav-tabs button.active {
            color: #667eea;
            border-bottom-color: #667eea;
        }

        .tab-content {
            padding: 30px;
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .tab-section h2 {
            color: #333;
            margin-bottom: 20px;
            font-size: 1.8em;
            border-bottom: 2px solid #667eea;
            padding-bottom: 10px;
        }

        .tab-section p {
            color: #666;
            margin-bottom: 20px;
            font-size: 14px;
        }

        .tax-controls {
            background: #f0f4ff;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            align-items: center;
        }

        .tax-control-group {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .tax-control-group label {
            font-weight: 500;
            color: #333;
        }

        .tax-control-group input[type="checkbox"] {
            width: auto;
            cursor: pointer;
        }

        .tax-control-group select {
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
            cursor: pointer;
        }

        .tax-control-group select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 5px rgba(102, 126, 234, 0.3);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }

        thead {
            background: #667eea;
            color: white;
        }

        th {
            padding: 15px;
            text-align: left;
            font-weight: 600;
        }

        td {
            padding: 12px 15px;
            border-bottom: 1px solid #e0e0e0;
        }

        tbody tr:hover {
            background: #f8f9fa;
        }

        tbody tr:nth-child(even) {
            background: #f8f9fa;
        }

        input {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
        }

        input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 5px rgba(102, 126, 234, 0.3);
        }

        input[readonly] {
            background-color: #f8f9fa;
            color: #666;
        }

        .revenue-row {
            font-weight: 700;
            background: #fffacd;
            border-top: 2px solid #667eea;
        }

        .tax-summary-row {
            font-weight: 700;
            background: #e0e7ff;
        }

        .total-row {
            font-weight: 700;
            background: #eef2ff;
        }

        .nav-links {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 5px;
            margin-bottom: 20px;
        }

        .nav-link {
            display: inline-block;
            margin-right: 15px;
            margin-bottom: 10px;
            padding: 10px 15px;
            background: white;
            border: 2px solid #667eea;
            color: #667eea;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .nav-link:hover {
            background: #667eea;
            color: white;
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
        }

        .modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background-color: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
            max-width: 400px;
            width: 90%;
        }

        .modal-content h3 {
            margin-top: 0;
            color: #333;
            margin-bottom: 20px;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            color: #333;
            font-weight: 500;
        }

        .form-group input {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
            box-sizing: border-box;
        }

        .form-group input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 5px rgba(102, 126, 234, 0.3);
        }

        .modal-buttons {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
            margin-top: 20px;
        }

        .modal-buttons button {
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .modal-buttons .btn-cancel {
            background: #e0e0e0;
            color: #333;
        }

        .modal-buttons .btn-cancel:hover {
            background: #d0d0d0;
        }

        .modal-buttons .btn-create {
            background: #667eea;
            color: white;
        }

        .modal-buttons .btn-create:hover {
            background: #5568d3;
        }

        .charts-container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
        }

        .chart-box {
            flex: 1 1 300px;
            min-width: 260px;
        }

        @media (max-width: 768px) {
            .nav-tabs {
                justify-content: flex-start;
            }

            .nav-tabs button {
                padding: 12px 15px;
                font-size: 12px;
            }

            .header h1 {
                font-size: 1.8em;
            }

            table {
                font-size: 0.9em;
            }

            th, td {
                padding: 8px 10px;
            }

            .tax-controls {
                flex-direction: column;
                align-items: flex-start;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üî™ Knife Inventory Manager v13</h1>
            <p>Manage Aaron and Pop's inventory, sales tracking, and taxes</p>
            <button class="nav-link" onclick="saveAppData()" style="margin-top:15px;">üíæ Save All Data</button>
        </div>

        <div class="nav-tabs">
            <button class="tab-btn active" onclick="openTab(event, 'master-inv')">üìã Master Inventory</button>
            <button class="tab-btn" onclick="openTab(event, 'aaron-nav')">Aaron Navigation</button>
            <button class="tab-btn" onclick="openTab(event, 'pop-nav')">Pop Navigation</button>
            <button class="tab-btn" onclick="openTab(event, 'aaron-inv')">Aaron Inventory</button>
            <button class="tab-btn" onclick="openTab(event, 'pop-inv')">Pop Inventory</button>
            <button class="tab-btn" onclick="openTab(event, 'sales-charts')">Sales Charts</button>
        </div>

        <!-- Master Inventory (Combined Pop + Aaron) -->
        <div id="master-inv" class="tab-content active">
            <div class="tab-section">
                <h2>Master Inventory - Combined Stock</h2>
                <p>Shows current stock levels for all 8 knife products across both Pop and Aaron inventories.</p>
                <table>
                    <thead>
                        <tr>
                            <th>Product Name</th>
                            <th>Pop Current Stock</th>
                            <th>Aaron Current Stock</th>
                            <th>Combined Total</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Full Tang</td>
                            <td><input type="number" class="master-pop-stock" data-product="0" readonly></td>
                            <td><input type="number" class="master-aaron-stock" data-product="0" readonly></td>
                            <td><input type="number" class="master-combined" data-product="0" readonly style="font-weight: bold;"></td>
                        </tr>
                        <tr>
                            <td>8&quot; Rat</td>
                            <td><input type="number" class="master-pop-stock" data-product="1" readonly></td>
                            <td><input type="number" class="master-aaron-stock" data-product="1" readonly></td>
                            <td><input type="number" class="master-combined" data-product="1" readonly style="font-weight: bold;"></td>
                        </tr>
                        <tr>
                            <td>6&quot; Rat</td>
                            <td><input type="number" class="master-pop-stock" data-product="2" readonly></td>
                            <td><input type="number" class="master-aaron-stock" data-product="2" readonly></td>
                            <td><input type="number" class="master-combined" data-product="2" readonly style="font-weight: bold;"></td>
                        </tr>
                        <tr>
                            <td>8&quot; Stag</td>
                            <td><input type="number" class="master-pop-stock" data-product="3" readonly></td>
                            <td><input type="number" class="master-aaron-stock" data-product="3" readonly></td>
                            <td><input type="number" class="master-combined" data-product="3" readonly style="font-weight: bold;"></td>
                        </tr>
                        <tr>
                            <td>6&quot; Stag</td>
                            <td><input type="number" class="master-pop-stock" data-product="4" readonly></td>
                            <td><input type="number" class="master-aaron-stock" data-product="4" readonly></td>
                            <td><input type="number" class="master-combined" data-product="4" readonly style="font-weight: bold;"></td>
                        </tr>
                        <tr>
                            <td>Grooved</td>
                            <td><input type="number" class="master-pop-stock" data-product="5" readonly></td>
                            <td><input type="number" class="master-aaron-stock" data-product="5" readonly></td>
                            <td><input type="number" class="master-combined" data-product="5" readonly style="font-weight: bold;"></td>
                        </tr>
                        <tr>
                            <td>Folders</td>
                            <td><input type="number" class="master-pop-stock" data-product="6" readonly></td>
                            <td><input type="number" class="master-aaron-stock" data-product="6" readonly></td>
                            <td><input type="number" class="master-combined" data-product="6" readonly style="font-weight: bold;"></td>
                        </tr>
                        <tr>
                            <td>Clipped Folder</td>
                            <td><input type="number" class="master-pop-stock" data-product="7" readonly></td>
                            <td><input type="number" class="master-aaron-stock" data-product="7" readonly></td>
                            <td><input type="number" class="master-combined" data-product="7" readonly style="font-weight: bold;"></td>
                        </tr>
                        <tr class="total-row">
                            <td><strong>GRAND TOTAL</strong></td>
                            <td><input type="number" id="master-pop-total" readonly style="font-weight: bold;"></td>
                            <td><input type="number" id="master-aaron-total" readonly style="font-weight: bold;"></td>
                            <td><input type="number" id="master-grand-total" readonly style="font-weight: bold; background: #667eea; color: white;"></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Aaron Navigation -->
        <div id="aaron-nav" class="tab-content">
            <div class="tab-section">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <h2 style="margin: 0;">Aaron's Inventory Management</h2>
                    <button class="nav-link" onclick="openNewAaronSalesSheetModal()" style="margin: 0;">+ New Sales Sheet</button>
                </div>
                <div class="nav-links">
                    <button class="nav-link" onclick="openTab(event, 'aaron-inv')">üìä Aaron Inventory</button>
                    <div id="dynamic-aaron-sales-links"></div>
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>Sheet Name</th>
                            <th>Description</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Aaron Inventory</strong></td>
                            <td>Current inventory levels and selling prices for all 8 knife products (auto-updates from sales)</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Pop Navigation -->
        <div id="pop-nav" class="tab-content">
            <div class="tab-section">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <h2 style="margin: 0;">Pop's Inventory Management</h2>
                    <button class="nav-link" onclick="openNewSalesSheetModal()" style="margin: 0;">+ New Sales Sheet</button>
                </div>
                <div class="nav-links">
                    <button class="nav-link" onclick="openTab(event, 'pop-inv')">üìä Pop Inventory</button>
                    <button class="nav-link" onclick="openTab(event, 'wetumpka')">üìç Wetumpka</button>
                    <button class="nav-link" onclick="openTab(event, 'mesquite')">üìç Mesquite</button>
                    <button class="nav-link" onclick="openTab(event, 'trussville')">üìç Trussville</button>
                    <button class="nav-link" onclick="openTab(event, 'columbia')">üìç Columbia</button>
                    <button class="nav-link" onclick="openTab(event, 'hattiesburg')">üìç Hattiesburg</button>
                    <div id="dynamic-sales-links"></div>
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>Sheet Name</th>
                            <th>Description</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Pop Inventory</strong></td>
                            <td>Current inventory levels and selling prices for all 8 knife products (auto-updates from sales)</td>
                        </tr>
                        <tr>
                            <td><strong>Wetumpka Alabama 12/12-13</strong></td>
                            <td>Sales tracking for Wetumpka gun show December 12-13</td>
                        </tr>
                        <tr>
                            <td><strong>Mesquite Texas 12/20-21</strong></td>
                            <td>Sales tracking for Mesquite gun show December 20-21</td>
                        </tr>
                        <tr>
                            <td><strong>Trussville Alabama 1/3-4</strong></td>
                            <td>Sales tracking for Trussville gun show January 3-4</td>
                        </tr>
                        <tr>
                            <td><strong>Columbia Tennessee 1/10-11</strong></td>
                            <td>Sales tracking for Columbia gun show January 10-11</td>
                        </tr>
                        <tr>
                            <td><strong>Hattiesburg Mississippi 1/17</strong></td>
                            <td>Sales tracking for Hattiesburg gun show January 17</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Aaron Inventory -->
        <div id="aaron-inv" class="tab-content">
            <div class="tab-section">
                <h2>Aaron's Current Inventory</h2>
                <table>
                    <thead>
                        <tr>
                            <th>Product Name</th>
                            <th>Selling Price</th>
                            <th>Storage Knives On Hand</th>
                            <th>Show Knives On Hand</th>
                            <th>Post Show Knives On Hand</th>
                            <th>Total Sold</th>
                            <th>Current Stock</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Full Tang</td>
                            <td><input type="number" placeholder="Enter price" class="aaron-price" data-product="0"></td>
                            <td><input type="number" placeholder="Storage" class="aaron-storage" data-product="0"></td>
                            <td><input type="number" placeholder="Show" class="aaron-show" data-product="0" readonly></td>
                            <td><input type="number" placeholder="Post Show" class="aaron-post-show" data-product="0" readonly></td>
                            <td><span class="total-sold" data-product="0">0</span></td>
                            <td><input type="number" class="aaron-current-stock" data-product="0" readonly value="0"></td>
                        </tr>
                        <tr>
                            <td>8&quot; Rat</td>
                            <td><input type="number" placeholder="Enter price" class="aaron-price" data-product="1"></td>
                            <td><input type="number" placeholder="Storage" class="aaron-storage" data-product="1"></td>
                            <td><input type="number" placeholder="Show" class="aaron-show" data-product="1" readonly></td>
                            <td><input type="number" placeholder="Post Show" class="aaron-post-show" data-product="1" readonly></td>
                            <td><span class="total-sold" data-product="1">0</span></td>
                            <td><input type="number" class="aaron-current-stock" data-product="1" readonly value="0"></td>
                        </tr>
                        <tr>
                            <td>6&quot; Rat</td>
                            <td><input type="number" placeholder="Enter price" class="aaron-price" data-product="2"></td>
                            <td><input type="number" placeholder="Storage" class="aaron-storage" data-product="2"></td>
                            <td><input type="number" placeholder="Show" class="aaron-show" data-product="2" readonly></td>
                            <td><input type="number" placeholder="Post Show" class="aaron-post-show" data-product="2" readonly></td>
                            <td><span class="total-sold" data-product="2">0</span></td>
                            <td><input type="number" class="aaron-current-stock" data-product="2" readonly value="0"></td>
                        </tr>
                        <tr>
                            <td>8&quot; Stag</td>
                            <td><input type="number" placeholder="Enter price" class="aaron-price" data-product="3"></td>
                            <td><input type="number" placeholder="Storage" class="aaron-storage" data-product="3"></td>
                            <td><input type="number" placeholder="Show" class="aaron-show" data-product="3" readonly></td>
                            <td><input type="number" placeholder="Post Show" class="aaron-post-show" data-product="3" readonly></td>
                            <td><span class="total-sold" data-product="3">0</span></td>
                            <td><input type="number" class="aaron-current-stock" data-product="3" readonly value="0"></td>
                        </tr>
                        <tr>
                            <td>6&quot; Stag</td>
                            <td><input type="number" placeholder="Enter price" class="aaron-price" data-product="4"></td>
                            <td><input type="number" placeholder="Storage" class="aaron-storage" data-product="4"></td>
                            <td><input type="number" placeholder="Show" class="aaron-show" data-product="4" readonly></td>
                            <td><input type="number" placeholder="Post Show" class="aaron-post-show" data-product="4" readonly></td>
                            <td><span class="total-sold" data-product="4">0</span></td>
                            <td><input type="number" class="aaron-current-stock" data-product="4" readonly value="0"></td>
                        </tr>
                        <tr>
                            <td>Grooved</td>
                            <td><input type="number" placeholder="Enter price" class="aaron-price" data-product="5"></td>
                            <td><input type="number" placeholder="Storage" class="aaron-storage" data-product="5"></td>
                            <td><input type="number" placeholder="Show" class="aaron-show" data-product="5" readonly></td>
                            <td><input type="number" placeholder="Post Show" class="aaron-post-show" data-product="5" readonly></td>
                            <td><span class="total-sold" data-product="5">0</span></td>
                            <td><input type="number" class="aaron-current-stock" data-product="5" readonly value="0"></td>
                        </tr>
                        <tr>
                            <td>Folders</td>
                            <td><input type="number" placeholder="Enter price" class="aaron-price" data-product="6"></td>
                            <td><input type="number" placeholder="Storage" class="aaron-storage" data-product="6"></td>
                            <td><input type="number" placeholder="Show" class="aaron-show" data-product="6" readonly></td>
                            <td><input type="number" placeholder="Post Show" class="aaron-post-show" data-product="6" readonly></td>
                            <td><span class="total-sold" data-product="6">0</span></td>
                            <td><input type="number" class="aaron-current-stock" data-product="6" readonly value="0"></td>
                        </tr>
                        <tr>
                            <td>Clipped Folder</td>
                            <td><input type="number" placeholder="Enter price" class="aaron-price" data-product="7"></td>
                            <td><input type="number" placeholder="Storage" class="aaron-storage" data-product="7"></td>
                            <td><input type="number" placeholder="Show" class="aaron-show" data-product="7" readonly></td>
                            <td><input type="number" placeholder="Post Show" class="aaron-post-show" data-product="7" readonly></td>
                            <td><span class="total-sold" data-product="7">0</span></td>
                            <td><input type="number" class="aaron-current-stock" data-product="7" readonly value="0"></td>
                        </tr>
                        <tr class="total-row">
                            <td colspan="6">Total knives on hand</td>
                            <td><input type="number" id="aaron-total-on-hand" readonly value="0"></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Pop Inventory -->
        <div id="pop-inv" class="tab-content">
            <div class="tab-section">
                <h2>Pop's Current Inventory</h2>
                <table>
                    <thead>
                        <tr>
                            <th>Product Name</th>
                            <th>Selling Price</th>
                            <th>Initial Storage</th>
                            <th>Show Knives On Hand</th>
                            <th>Post Show Knives On Hand</th>
                            <th>Total Sold</th>
                            <th>Current Stock</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Full Tang</td>
                            <td><input type="number" placeholder="Enter price" class="pop-price" data-product="0"></td>
                            <td><input type="number" value="314" class="pop-storage" data-product="0"></td>
                            <td><input type="number" placeholder="Show" class="pop-show" data-product="0" readonly></td>
                            <td><input type="number" placeholder="Post Show" class="pop-post-show" data-product="0" readonly></td>
                            <td><span class="total-sold-pop" data-product="0">0</span></td>
                            <td><input type="number" class="pop-current-stock" data-product="0" readonly value="314"></td>
                        </tr>
                        <tr>
                            <td>8&quot; Rat</td>
                            <td><input type="number" placeholder="Enter price" class="pop-price" data-product="1"></td>
                            <td><input type="number" value="112" class="pop-storage" data-product="1"></td>
                            <td><input type="number" placeholder="Show" class="pop-show" data-product="1" readonly></td>
                            <td><input type="number" placeholder="Post Show" class="pop-post-show" data-product="1" readonly></td>
                            <td><span class="total-sold-pop" data-product="1">0</span></td>
                            <td><input type="number" class="pop-current-stock" data-product="1" readonly value="112"></td>
                        </tr>
                        <tr>
                            <td>6&quot; Rat</td>
                            <td><input type="number" placeholder="Enter price" class="pop-price" data-product="2"></td>
                            <td><input type="number" value="164" class="pop-storage" data-product="2"></td>
                            <td><input type="number" placeholder="Show" class="pop-show" data-product="2" readonly></td>
                            <td><input type="number" placeholder="Post Show" class="pop-post-show" data-product="2" readonly></td>
                            <td><span class="total-sold-pop" data-product="2">0</span></td>
                            <td><input type="number" class="pop-current-stock" data-product="2" readonly value="164"></td>
                        </tr>
                        <tr>
                            <td>8&quot; Stag</td>
                            <td><input type="number" placeholder="Enter price" class="pop-price" data-product="3"></td>
                            <td><input type="number" value="91" class="pop-storage" data-product="3"></td>
                            <td><input type="number" placeholder="Show" class="pop-show" data-product="3" readonly></td>
                            <td><input type="number" placeholder="Post Show" class="pop-post-show" data-product="3" readonly></td>
                            <td><span class="total-sold-pop" data-product="3">0</span></td>
                            <td><input type="number" class="pop-current-stock" data-product="3" readonly value="91"></td>
                        </tr>
                        <tr>
                            <td>6&quot; Stag</td>
                            <td><input type="number" placeholder="Enter price" class="pop-price" data-product="4"></td>
                            <td><input type="number" value="132" class="pop-storage" data-product="4"></td>
                            <td><input type="number" placeholder="Show" class="pop-show" data-product="4" readonly></td>
                            <td><input type="number" placeholder="Post Show" class="pop-post-show" data-product="4" readonly></td>
                            <td><span class="total-sold-pop" data-product="4">0</span></td>
                            <td><input type="number" class="pop-current-stock" data-product="4" readonly value="132"></td>
                        </tr>
                        <tr>
                            <td>Grooved</td>
                            <td><input type="number" placeholder="Enter price" class="pop-price" data-product="5"></td>
                            <td><input type="number" value="17" class="pop-storage" data-product="5"></td>
                            <td><input type="number" placeholder="Show" class="pop-show" data-product="5" readonly></td>
                            <td><input type="number" placeholder="Post Show" class="pop-post-show" data-product="5" readonly></td>
                            <td><span class="total-sold-pop" data-product="5">0</span></td>
                            <td><input type="number" class="pop-current-stock" data-product="5" readonly value="17"></td>
                        </tr>
                        <tr>
                            <td>Folders</td>
                            <td><input type="number" placeholder="Enter price" class="pop-price" data-product="6"></td>
                            <td><input type="number" value="66" class="pop-storage" data-product="6"></td>
                            <td><input type="number" placeholder="Show" class="pop-show" data-product="6" readonly></td>
                            <td><input type="number" placeholder="Post Show" class="pop-post-show" data-product="6" readonly></td>
                            <td><span class="total-sold-pop" data-product="6">0</span></td>
                            <td><input type="number" class="pop-current-stock" data-product="6" readonly value="66"></td>
                        </tr>
                        <tr>
                            <td>Clipped Folder</td>
                            <td><input type="number" placeholder="Enter price" class="pop-price" data-product="7"></td>
                            <td><input type="number" value="18" class="pop-storage" data-product="7"></td>
                            <td><input type="number" placeholder="Show" class="pop-show" data-product="7" readonly></td>
                            <td><input type="number" placeholder="Post Show" class="pop-post-show" data-product="7" readonly></td>
                            <td><span class="total-sold-pop" data-product="7">0</span></td>
                            <td><input type="number" class="pop-current-stock" data-product="7" readonly value="18"></td>
                        </tr>
                        <tr class="total-row">
                            <td colspan="6">Total knives on hand</td>
                            <td><input type="number" id="pop-total-on-hand" readonly value="0"></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Wetumpka (Pop) -->
        <div id="wetumpka" class="tab-content">
            <div class="tab-section">
                <h2>Wetumpka, Alabama - December 12-13</h2>
                <div class="tax-controls">
                    <div class="tax-control-group">
                        <input type="checkbox" id="tax-required-wetumpka" class="tax-checkbox" data-sheet="wetumpka">
                        <label for="tax-required-wetumpka">Sales Tax Required?</label>
                    </div>
                    <div class="tax-control-group">
                        <label for="state-select-wetumpka">State:</label>
                        <select id="state-select-wetumpka" class="state-select" data-sheet="wetumpka" onchange="updateCityDropdown('wetumpka')">
                            <option value="">-- Select State --</option>
                        </select>
                    </div>
                    <div class="tax-control-group">
                        <label for="city-select-wetumpka">City:</label>
                        <select id="city-select-wetumpka" class="city-select" data-sheet="wetumpka" onchange="updateTaxCalculation('wetumpka')">
                            <option value="">-- Select City --</option>
                        </select>
                    </div>
                </div>
                <label style="display:inline-flex;align-items:center;gap:6px;margin-bottom:10px;font-size:13px;">
                    <input type="radio" name="pop-active-sheet" class="pop-active-radio" value="wetumpka">
                    Use this sheet as Pop's active show
                </label>
                <table>
                    <thead>
                        <tr>
                            <th>Product Name</th>
                            <th>Units Brought</th>
                            <th>Units Sold</th>
                            <th>Units Left</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Full Tang</td>
                            <td><input type="number" class="units-brought" data-sheet="wetumpka" data-row="0"></td>
                            <td><input type="number" class="units-sold" data-sheet="wetumpka" data-row="0" readonly></td>
                            <td><input type="number" class="units-left" data-sheet="wetumpka" data-row="0"></td>
                        </tr>
                        <tr>
                            <td>8&quot; Rat</td>
                            <td><input type="number" class="units-brought" data-sheet="wetumpka" data-row="1"></td>
                            <td><input type="number" class="units-sold" data-sheet="wetumpka" data-row="1" readonly></td>
                            <td><input type="number" class="units-left" data-sheet="wetumpka" data-row="1"></td>
                        </tr>
                        <tr>
                            <td>6&quot; Rat</td>
                            <td><input type="number" class="units-brought" data-sheet="wetumpka" data-row="2"></td>
                            <td><input type="number" class="units-sold" data-sheet="wetumpka" data-row="2" readonly></td>
                            <td><input type="number" class="units-left" data-sheet="wetumpka" data-row="2"></td>
                        </tr>
                        <tr>
                            <td>8&quot; Stag</td>
                            <td><input type="number" class="units-brought" data-sheet="wetumpka" data-row="3"></td>
                            <td><input type="number" class="units-sold" data-sheet="wetumpka" data-row="3" readonly></td>
                            <td><input type="number" class="units-left" data-sheet="wetumpka" data-row="3"></td>
                        </tr>
                        <tr>
                            <td>6&quot; Stag</td>
                            <td><input type="number" class="units-brought" data-sheet="wetumpka" data-row="4"></td>
                            <td><input type="number" class="units-sold" data-sheet="wetumpka" data-row="4" readonly></td>
                            <td><input type="number" class="units-left" data-sheet="wetumpka" data-row="4"></td>
                        </tr>
                        <tr>
                            <td>Grooved</td>
                            <td><input type="number" class="units-brought" data-sheet="wetumpka" data-row="5"></td>
                            <td><input type="number" class="units-sold" data-sheet="wetumpka" data-row="5" readonly></td>
                            <td><input type="number" class="units-left" data-sheet="wetumpka" data-row="5"></td>
                        </tr>
                        <tr>
                            <td>Folders</td>
                            <td><input type="number" class="units-brought" data-sheet="wetumpka" data-row="6"></td>
                            <td><input type="number" class="units-sold" data-sheet="wetumpka" data-row="6" readonly></td>
                            <td><input type="number" class="units-left" data-sheet="wetumpka" data-row="6"></td>
                        </tr>
                        <tr>
                            <td>Clipped Folder</td>
                            <td><input type="number" class="units-brought" data-sheet="wetumpka" data-row="7"></td>
                            <td><input type="number" class="units-sold" data-sheet="wetumpka" data-row="7" readonly></td>
                            <td><input type="number" class="units-left" data-sheet="wetumpka" data-row="7"></td>
                        </tr>
                        <tr class="revenue-row">
                            <td><strong>TOTAL REVENUE</strong></td>
                            <td colspan="2"><input type="number" class="revenue-total" data-sheet="wetumpka" readonly></td>
                            <td></td>
                        </tr>
                        <tr class="tax-summary-row" id="tax-row-wetumpka" style="display:none;">
                            <td><strong>Subtotal | Tax | Total</strong></td>
                            <td colspan="2"><input type="text" class="tax-summary" data-sheet="wetumpka" readonly style="font-weight: bold;"></td>
                            <td></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Mesquite (Pop) -->
        <div id="mesquite" class="tab-content">
            <div class="tab-section">
                <h2>Mesquite, Texas - December 20-21</h2>
                <div class="tax-controls">
                    <div class="tax-control-group">
                        <input type="checkbox" id="tax-required-mesquite" class="tax-checkbox" data-sheet="mesquite">
                        <label for="tax-required-mesquite">Sales Tax Required?</label>
                    </div>
                    <div class="tax-control-group">
                        <label for="state-select-mesquite">State:</label>
                        <select id="state-select-mesquite" class="state-select" data-sheet="mesquite" onchange="updateCityDropdown('mesquite')">
                            <option value="">-- Select State --</option>
                        </select>
                    </div>
                    <div class="tax-control-group">
                        <label for="city-select-mesquite">City:</label>
                        <select id="city-select-mesquite" class="city-select" data-sheet="mesquite" onchange="updateTaxCalculation('mesquite')">
                            <option value="">-- Select City --</option>
                        </select>
                    </div>
                </div>
                <label style="display:inline-flex;align-items:center;gap:6px;margin-bottom:10px;font-size:13px;">
                    <input type="radio" name="pop-active-sheet" class="pop-active-radio" value="mesquite">
                    Use this sheet as Pop's active show
                </label>
                <table>
                    <thead>
                        <tr>
                            <th>Product Name</th>
                            <th>Units Brought</th>
                            <th>Units Sold</th>
                            <th>Units Left</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Full Tang</td>
                            <td><input type="number" class="units-brought" data-sheet="mesquite" data-row="0"></td>
                            <td><input type="number" class="units-sold" data-sheet="mesquite" data-row="0" readonly></td>
                            <td><input type="number" class="units-left" data-sheet="mesquite" data-row="0"></td>
                        </tr>
                        <tr>
                            <td>8&quot; Rat</td>
                            <td><input type="number" class="units-brought" data-sheet="mesquite" data-row="1"></td>
                            <td><input type="number" class="units-sold" data-sheet="mesquite" data-row="1" readonly></td>
                            <td><input type="number" class="units-left" data-sheet="mesquite" data-row="1"></td>
                        </tr>
                        <tr>
                            <td>6&quot; Rat</td>
                            <td><input type="number" class="units-brought" data-sheet="mesquite" data-row="2"></td>
                            <td><input type="number" class="units-sold" data-sheet="mesquite" data-row="2" readonly></td>
                            <td><input type="number" class="units-left" data-sheet="mesquite" data-row="2"></td>
                        </tr>
                        <tr>
                            <td>8&quot; Stag</td>
                            <td><input type="number" class="units-brought" data-sheet="mesquite" data-row="3"></td>
                            <td><input type="number" class="units-sold" data-sheet="mesquite" data-row="3" readonly></td>
                            <td><input type="number" class="units-left" data-sheet="mesquite" data-row="3"></td>
                        </tr>
                        <tr>
                            <td>6&quot; Stag</td>
                            <td><input type="number" class="units-brought" data-sheet="mesquite" data-row="4"></td>
                            <td><input type="number" class="units-sold" data-sheet="mesquite" data-row="4" readonly></td>
                            <td><input type="number" class="units-left" data-sheet="mesquite" data-row="4"></td>
                        </tr>
                        <tr>
                            <td>Grooved</td>
                            <td><input type="number" class="units-brought" data-sheet="mesquite" data-row="5"></td>
                            <td><input type="number" class="units-sold" data-sheet="mesquite" data-row="5" readonly></td>
                            <td><input type="number" class="units-left" data-sheet="mesquite" data-row="5"></td>
                        </tr>
                        <tr>
                            <td>Folders</td>
                            <td><input type="number" class="units-brought" data-sheet="mesquite" data-row="6"></td>
                            <td><input type="number" class="units-sold" data-sheet="mesquite" data-row="6" readonly></td>
                            <td><input type="number" class="units-left" data-sheet="mesquite" data-row="6"></td>
                        </tr>
                        <tr>
                            <td>Clipped Folder</td>
                            <td><input type="number" class="units-brought" data-sheet="mesquite" data-row="7"></td>
                            <td><input type="number" class="units-sold" data-sheet="mesquite" data-row="7" readonly></td>
                            <td><input type="number" class="units-left" data-sheet="mesquite" data-row="7"></td>
                        </tr>
                        <tr class="revenue-row">
                            <td><strong>TOTAL REVENUE</strong></td>
                            <td colspan="2"><input type="number" class="revenue-total" data-sheet="mesquite" readonly></td>
                            <td></td>
                        </tr>
                        <tr class="tax-summary-row" id="tax-row-mesquite" style="display:none;">
                            <td><strong>Subtotal | Tax | Total</strong></td>
                            <td colspan="2"><input type="text" class="tax-summary" data-sheet="mesquite" readonly style="font-weight: bold;"></td>
                            <td></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Trussville (Pop) -->
        <div id="trussville" class="tab-content">
            <div class="tab-section">
                <h2>Trussville, Alabama - January 3-4</h2>
                <div class="tax-controls">
                    <div class="tax-control-group">
                        <input type="checkbox" id="tax-required-trussville" class="tax-checkbox" data-sheet="trussville">
                        <label for="tax-required-trussville">Sales Tax Required?</label>
                    </div>
                    <div class="tax-control-group">
                        <label for="state-select-trussville">State:</label>
                        <select id="state-select-trussville" class="state-select" data-sheet="trussville" onchange="updateCityDropdown('trussville')">
                            <option value="">-- Select State --</option>
                        </select>
                    </div>
                    <div class="tax-control-group">
                        <label for="city-select-trussville">City:</label>
                        <select id="city-select-trussville" class="city-select" data-sheet="trussville" onchange="updateTaxCalculation('trussville')">
                            <option value="">-- Select City --</option>
                        </select>
                    </div>
                </div>
                <label style="display:inline-flex;align-items:center;gap:6px;margin-bottom:10px;font-size:13px;">
                    <input type="radio" name="pop-active-sheet" class="pop-active-radio" value="trussville">
                    Use this sheet as Pop's active show
                </label>
                <table>
                    <thead>
                        <tr>
                            <th>Product Name</th>
                            <th>Units Brought</th>
                            <th>Units Sold</th>
                            <th>Units Left</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Full Tang</td>
                            <td><input type="number" class="units-brought" data-sheet="trussville" data-row="0"></td>
                            <td><input type="number" class="units-sold" data-sheet="trussville" data-row="0" readonly></td>
                            <td><input type="number" class="units-left" data-sheet="trussville" data-row="0"></td>
                        </tr>
                        <tr>
                            <td>8&quot; Rat</td>
                            <td><input type="number" class="units-brought" data-sheet="trussville" data-row="1"></td>
                            <td><input type="number" class="units-sold" data-sheet="trussville" data-row="1" readonly></td>
                            <td><input type="number" class="units-left" data-sheet="trussville" data-row="1"></td>
                        </tr>
                        <tr>
                            <td>6&quot; Rat</td>
                            <td><input type="number" class="units-brought" data-sheet="trussville" data-row="2"></td>
                            <td><input type="number" class="units-sold" data-sheet="trussville" data-row="2" readonly></td>
                            <td><input type="number" class="units-left" data-sheet="trussville" data-row="2"></td>
                        </tr>
                        <tr>
                            <td>8&quot; Stag</td>
                            <td><input type="number" class="units-brought" data-sheet="trussville" data-row="3"></td>
                            <td><input type="number" class="units-sold" data-sheet="trussville" data-row="3" readonly></td>
                            <td><input type="number" class="units-left" data-sheet="trussville" data-row="3"></td>
                        </tr>
                        <tr>
                            <td>6&quot; Stag</td>
                            <td><input type="number" class="units-brought" data-sheet="trussville" data-row="4"></td>
                            <td><input type="number" class="units-sold" data-sheet="trussville" data-row="4" readonly></td>
                            <td><input type="number" class="units-left" data-sheet="trussville" data-row="4"></td>
                        </tr>
                        <tr>
                            <td>Grooved</td>
                            <td><input type="number" class="units-brought" data-sheet="trussville" data-row="5"></td>
                            <td><input type="number" class="units-sold" data-sheet="trussville" data-row="5" readonly></td>
                            <td><input type="number" class="units-left" data-sheet="trussville" data-row="5"></td>
                        </tr>
                        <tr>
                            <td>Folders</td>
                            <td><input type="number" class="units-brought" data-sheet="trussville" data-row="6"></td>
                            <td><input type="number" class="units-sold" data-sheet="trussville" data-row="6" readonly></td>
                            <td><input type="number" class="units-left" data-sheet="trussville" data-row="6"></td>
                        </tr>
                        <tr>
                            <td>Clipped Folder</td>
                            <td><input type="number" class="units-brought" data-sheet="trussville" data-row="7"></td>
                            <td><input type="number" class="units-sold" data-sheet="trussville" data-row="7" readonly></td>
                            <td><input type="number" class="units-left" data-sheet="trussville" data-row="7"></td>
                        </tr>
                        <tr class="revenue-row">
                            <td><strong>TOTAL REVENUE</strong></td>
                            <td colspan="2"><input type="number" class="revenue-total" data-sheet="trussville" readonly></td>
                            <td></td>
                        </tr>
                        <tr class="tax-summary-row" id="tax-row-trussville" style="display:none;">
                            <td><strong>Subtotal | Tax | Total</strong></td>
                            <td colspan="2"><input type="text" class="tax-summary" data-sheet="trussville" readonly style="font-weight: bold;"></td>
                            <td></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Columbia (Pop) -->
        <div id="columbia" class="tab-content">
            <div class="tab-section">
                <h2>Columbia, Tennessee - January 10-11</h2>
                <div class="tax-controls">
                    <div class="tax-control-group">
                        <input type="checkbox" id="tax-required-columbia" class="tax-checkbox" data-sheet="columbia">
                        <label for="tax-required-columbia">Sales Tax Required?</label>
                    </div>
                    <div class="tax-control-group">
                        <label for="state-select-columbia">State:</label>
                        <select id="state-select-columbia" class="state-select" data-sheet="columbia" onchange="updateCityDropdown('columbia')">
                            <option value="">-- Select State --</option>
                        </select>
                    </div>
                    <div class="tax-control-group">
                        <label for="city-select-columbia">City:</label>
                        <select id="city-select-columbia" class="city-select" data-sheet="columbia" onchange="updateTaxCalculation('columbia')">
                            <option value="">-- Select City --</option>
                        </select>
                    </div>
                </div>
                <label style="display:inline-flex;align-items:center;gap:6px;margin-bottom:10px;font-size:13px;">
                    <input type="radio" name="pop-active-sheet" class="pop-active-radio" value="columbia">
                    Use this sheet as Pop's active show
                </label>
                <table>
                    <thead>
                        <tr>
                            <th>Product Name</th>
                            <th>Units Brought</th>
                            <th>Units Sold</th>
                            <th>Units Left</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Full Tang</td>
                            <td><input type="number" class="units-brought" data-sheet="columbia" data-row="0"></td>
                            <td><input type="number" class="units-sold" data-sheet="columbia" data-row="0" readonly></td>
                            <td><input type="number" class="units-left" data-sheet="columbia" data-row="0"></td>
                        </tr>
                        <tr>
                            <td>8&quot; Rat</td>
                            <td><input type="number" class="units-brought" data-sheet="columbia" data-row="1"></td>
                            <td><input type="number" class="units-sold" data-sheet="columbia" data-row="1" readonly></td>
                            <td><input type="number" class="units-left" data-sheet="columbia" data-row="1"></td>
                        </tr>
                        <tr>
                            <td>6&quot; Rat</td>
                            <td><input type="number" class="units-brought" data-sheet="columbia" data-row="2"></td>
                            <td><input type="number" class="units-sold" data-sheet="columbia" data-row="2" readonly></td>
                            <td><input type="number" class="units-left" data-sheet="columbia" data-row="2"></td>
                        </tr>
                        <tr>
                            <td>8&quot; Stag</td>
                            <td><input type="number" class="units-brought" data-sheet="columbia" data-row="3"></td>
                            <td><input type="number" class="units-sold" data-sheet="columbia" data-row="3" readonly></td>
                            <td><input type="number" class="units-left" data-sheet="columbia" data-row="3"></td>
                        </tr>
                        <tr>
                            <td>6&quot; Stag</td>
                            <td><input type="number" class="units-brought" data-sheet="columbia" data-row="4"></td>
                            <td><input type="number" class="units-sold" data-sheet="columbia" data-row="4" readonly></td>
                            <td><input type="number" class="units-left" data-sheet="columbia" data-row="4"></td>
                        </tr>
                        <tr>
                            <td>Grooved</td>
                            <td><input type="number" class="units-brought" data-sheet="columbia" data-row="5"></td>
                            <td><input type="number" class="units-sold" data-sheet="columbia" data-row="5" readonly></td>
                            <td><input type="number" class="units-left" data-sheet="columbia" data-row="5"></td>
                        </tr>
                        <tr>
                            <td>Folders</td>
                            <td><input type="number" class="units-brought" data-sheet="columbia" data-row="6"></td>
                            <td><input type="number" class="units-sold" data-sheet="columbia" data-row="6" readonly></td>
                            <td><input type="number" class="units-left" data-sheet="columbia" data-row="6"></td>
                        </tr>
                        <tr>
                            <td>Clipped Folder</td>
                            <td><input type="number" class="units-brought" data-sheet="columbia" data-row="7"></td>
                            <td><input type="number" class="units-sold" data-sheet="columbia" data-row="7" readonly></td>
                            <td><input type="number" class="units-left" data-sheet="columbia" data-row="7"></td>
                        </tr>
                        <tr class="revenue-row">
                            <td><strong>TOTAL REVENUE</strong></td>
                            <td colspan="2"><input type="number" class="revenue-total" data-sheet="columbia" readonly></td>
                            <td></td>
                        </tr>
                        <tr class="tax-summary-row" id="tax-row-columbia" style="display:none;">
                            <td><strong>Subtotal | Tax | Total</strong></td>
                            <td colspan="2"><input type="text" class="tax-summary" data-sheet="columbia" readonly style="font-weight: bold;"></td>
                            <td></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Hattiesburg (Pop) -->
        <div id="hattiesburg" class="tab-content">
            <div class="tab-section">
                <h2>Hattiesburg, Mississippi - January 17</h2>
                <div class="tax-controls">
                    <div class="tax-control-group">
                        <input type="checkbox" id="tax-required-hattiesburg" class="tax-checkbox" data-sheet="hattiesburg">
                        <label for="tax-required-hattiesburg">Sales Tax Required?</label>
                    </div>
                    <div class="tax-control-group">
                        <label for="state-select-hattiesburg">State:</label>
                        <select id="state-select-hattiesburg" class="state-select" data-sheet="hattiesburg" onchange="updateCityDropdown('hattiesburg')">
                            <option value="">-- Select State --</option>
                        </select>
                    </div>
                    <div class="tax-control-group">
                        <label for="city-select-hattiesburg">City:</label>
                        <select id="city-select-hattiesburg" class="city-select" data-sheet="hattiesburg" onchange="updateTaxCalculation('hattiesburg')">
                            <option value="">-- Select City --</option>
                        </select>
                    </div>
                </div>
                <label style="display:inline-flex;align-items:center;gap:6px;margin-bottom:10px;font-size:13px;">
                    <input type="radio" name="pop-active-sheet" class="pop-active-radio" value="hattiesburg">
                    Use this sheet as Pop's active show
                </label>
                <table>
                    <thead>
                        <tr>
                            <th>Product Name</th>
                            <th>Units Brought</th>
                            <th>Units Sold</th>
                            <th>Units Left</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Full Tang</td>
                            <td><input type="number" class="units-brought" data-sheet="hattiesburg" data-row="0"></td>
                            <td><input type="number" class="units-sold" data-sheet="hattiesburg" data-row="0" readonly></td>
                            <td><input type="number" class="units-left" data-sheet="hattiesburg" data-row="0"></td>
                        </tr>
                        <tr>
                            <td>8&quot; Rat</td>
                            <td><input type="number" class="units-brought" data-sheet="hattiesburg" data-row="1"></td>
                            <td><input type="number" class="units-sold" data-sheet="hattiesburg" data-row="1" readonly></td>
                            <td><input type="number" class="units-left" data-sheet="hattiesburg" data-row="1"></td>
                        </tr>
                        <tr>
                            <td>6&quot; Rat</td>
                            <td><input type="number" class="units-brought" data-sheet="hattiesburg" data-row="2"></td>
                            <td><input type="number" class="units-sold" data-sheet="hattiesburg" data-row="2" readonly></td>
                            <td><input type="number" class="units-left" data-sheet="hattiesburg" data-row="2"></td>
                        </tr>
                        <tr>
                            <td>8&quot; Stag</td>
                            <td><input type="number" class="units-brought" data-sheet="hattiesburg" data-row="3"></td>
                            <td><input type="number" class="units-sold" data-sheet="hattiesburg" data-row="3" readonly></td>
                            <td><input type="number" class="units-left" data-sheet="hattiesburg" data-row="3"></td>
                        </tr>
                        <tr>
                            <td>6&quot; Stag</td>
                            <td><input type="number" class="units-brought" data-sheet="hattiesburg" data-row="4"></td>
                            <td><input type="number" class="units-sold" data-sheet="hattiesburg" data-row="4" readonly></td>
                            <td><input type="number" class="units-left" data-sheet="hattiesburg" data-row="4"></td>
                        </tr>
                        <tr>
                            <td>Grooved</td>
                            <td><input type="number" class="units-brought" data-sheet="hattiesburg" data-row="5"></td>
                            <td><input type="number" class="units-sold" data-sheet="hattiesburg" data-row="5" readonly></td>
                            <td><input type="number" class="units-left" data-sheet="hattiesburg" data-row="5"></td>
                        </tr>
                        <tr>
                            <td>Folders</td>
                            <td><input type="number" class="units-brought" data-sheet="hattiesburg" data-row="6"></td>
                            <td><input type="number" class="units-sold" data-sheet="hattiesburg" data-row="6" readonly></td>
                            <td><input type="number" class="units-left" data-sheet="hattiesburg" data-row="6"></td>
                        </tr>
                        <tr>
                            <td>Clipped Folder</td>
                            <td><input type="number" class="units-brought" data-sheet="hattiesburg" data-row="7"></td>
                            <td><input type="number" class="units-sold" data-sheet="hattiesburg" data-row="7" readonly></td>
                            <td><input type="number" class="units-left" data-sheet="hattiesburg" data-row="7"></td>
                        </tr>
                        <tr class="revenue-row">
                            <td><strong>TOTAL REVENUE</strong></td>
                            <td colspan="2"><input type="number" class="revenue-total" data-sheet="hattiesburg" readonly></td>
                            <td></td>
                        </tr>
                        <tr class="tax-summary-row" id="tax-row-hattiesburg" style="display:none;">
                            <td><strong>Subtotal | Tax | Total</strong></td>
                            <td colspan="2"><input type="text" class="tax-summary" data-sheet="hattiesburg" readonly style="font-weight: bold;"></td>
                            <td></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Sales Charts -->
        <div id="sales-charts" class="tab-content">
            <div class="tab-section">
                <h2>Sales Tracking Charts</h2>
                <p>Shows overall knife sales percentages for Pop and Aaron combined.</p>
                <div class="charts-container">
                    <div class="chart-box">
                        <h3>Sales percentage by knife</h3>
                        <canvas id="salesPieChart"></canvas>
                    </div>
                    <div class="chart-box">
                        <h3>Total units sold by knife</h3>
                        <canvas id="salesBarChart"></canvas>
                    </div>
                </div>
                <button class="nav-link" onclick="refreshSalesCharts()" style="margin-top: 20px;">üîÑ Refresh Charts</button>
            </div>
        </div>
    </div>

    <!-- Modal for New Aaron Sales Sheet -->
    <div id="newAaronSalesModal" class="modal">
        <div class="modal-content">
            <h3>Create New Aaron Sales Sheet</h3>
            <form onsubmit="event.preventDefault(); createNewAaronSalesSheet();">
                <div class="form-group">
                    <label for="aaronSheetName">Sheet Name:</label>
                    <input type="text" id="aaronSheetName" placeholder="e.g., Denver Colorado" required>
                </div>
                <div class="form-group">
                    <label for="aaronSheetDate">Date:</label>
                    <input type="text" id="aaronSheetDate" placeholder="e.g., 2/14-15" required>
                </div>
                <div class="modal-buttons">
                    <button type="button" class="btn-cancel" onclick="closeNewAaronSalesSheetModal()">Cancel</button>
                    <button type="submit" class="btn-create">Create Sheet</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal for New Pop Sales Sheet -->
    <div id="newSalesModal" class="modal">
        <div class="modal-content">
            <h3>Create New Pop Sales Sheet</h3>
            <form onsubmit="event.preventDefault(); createNewSalesSheet();">
                <div class="form-group">
                    <label for="sheetName">Sheet Name:</label>
                    <input type="text" id="sheetName" placeholder="e.g., Denver Colorado" required>
                </div>
                <div class="form-group">
                    <label for="sheetDate">Date:</label>
                    <input type="text" id="sheetDate" placeholder="e.g., 2/14-15" required>
                </div>
                <div class="modal-buttons">
                    <button type="button" class="btn-cancel" onclick="closeNewSalesSheetModal()">Cancel</button>
                    <button type="submit" class="btn-create">Create Sheet</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Chart.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <script>
        // US Sales Tax Database
        const TAX_DATABASE = {
            "Alabama": {"rate": 0.04, "cities": ["Wetumpka", "Trussville", "Birmingham", "Montgomery", "Huntsville", "Mobile", "Tuscaloosa"]},
            "Alaska": {"rate": 0.00, "cities": ["Anchorage", "Juneau", "Fairbanks", "Ketchikan", "Sitka"]},
            "Arizona": {"rate": 0.056, "cities": ["Phoenix", "Tucson", "Mesa", "Chandler", "Scottsdale", "Glendale", "Gilbert"]},
            "Arkansas": {"rate": 0.065, "cities": ["Little Rock", "Fort Smith", "Fayetteville", "Springdale", "Jonesboro", "Pine Bluff"]},
            "California": {"rate": 0.0725, "cities": ["Los Angeles", "San Francisco", "San Diego", "San Jose", "Fresno", "Sacramento", "Oakland"]},
            "Colorado": {"rate": 0.029, "cities": ["Denver", "Colorado Springs", "Aurora", "Fort Collins", "Lakewood", "Thornton"]},
            "Connecticut": {"rate": 0.065, "cities": ["Bridgeport", "New Haven", "Hartford", "Waterbury", "Danbury", "Stamford"]},
            "Delaware": {"rate": 0.00, "cities": ["Wilmington", "Dover", "Newark", "Middletown", "Smyrna"]},
            "Florida": {"rate": 0.06, "cities": ["Jacksonville", "Miami", "Tampa", "Orlando", "St. Petersburg", "Hialeah", "Fort Lauderdale"]},
            "Georgia": {"rate": 0.04, "cities": ["Atlanta", "Augusta", "Columbus", "Savannah", "Macon", "Albany"]},
            "Hawaii": {"rate": 0.04, "cities": ["Honolulu", "Hilo", "Kailua", "Kaneohe", "Mililani"]},
            "Idaho": {"rate": 0.06, "cities": ["Boise", "Meridian", "Nampa", "Idaho Falls", "Pocatello", "Caldwell"]},
            "Illinois": {"rate": 0.0625, "cities": ["Chicago", "Aurora", "Rockford", "Joliet", "Naperville", "Springfield", "Peoria"]},
            "Indiana": {"rate": 0.07, "cities": ["Indianapolis", "Fort Wayne", "Evansville", "South Bend", "Bloomington", "Gary"]},
            "Iowa": {"rate": 0.06, "cities": ["Des Moines", "Cedar Rapids", "Davenport", "Iowa City", "Dubuque", "Ames"]},
            "Kansas": {"rate": 0.0685, "cities": ["Kansas City", "Wichita", "Overland Park", "Topeka", "Olathe", "Lawrence"]},
            "Kentucky": {"rate": 0.06, "cities": ["Louisville", "Lexington", "Bowling Green", "Owensboro", "Covington", "Richmond"]},
            "Louisiana": {"rate": 0.07, "cities": ["New Orleans", "Baton Rouge", "Shreveport", "Lafayette", "Lake Charles", "Monroe"]},
            "Maine": {"rate": 0.055, "cities": ["Portland", "Lewiston", "Bangor", "South Portland", "Auburn", "Waterville"]},
            "Maryland": {"rate": 0.06, "cities": ["Baltimore", "Columbia", "Germantown", "Silver Spring", "Towson", "Glen Burnie"]},
            "Massachusetts": {"rate": 0.0625, "cities": ["Boston", "Worcester", "Springfield", "Cambridge", "Lowell", "Brockton"]},
            "Michigan": {"rate": 0.06, "cities": ["Detroit", "Grand Rapids", "Warren", "Sterling Heights", "Ann Arbor", "Lansing"]},
            "Minnesota": {"rate": 0.0685, "cities": ["Minneapolis", "St. Paul", "Bloomington", "Rochester", "Saint Cloud", "Duluth"]},
            "Mississippi": {"rate": 0.07, "cities": ["Hattiesburg", "Jackson", "Gulfport", "Biloxi", "Southaven", "Greenville"]},
            "Missouri": {"rate": 0.0725, "cities": ["Kansas City", "St. Louis", "Springfield", "Columbia", "Independence", "Lee's Summit"]},
            "Montana": {"rate": 0.00, "cities": ["Billings", "Missoula", "Great Falls", "Butte", "Bozeman"]},
            "Nebraska": {"rate": 0.055, "cities": ["Omaha", "Lincoln", "Bellevue", "Grand Island", "Kearney"]},
            "Nevada": {"rate": 0.0685, "cities": ["Las Vegas", "Henderson", "Reno", "North Las Vegas", "Sparks"]},
            "New Hampshire": {"rate": 0.00, "cities": ["Manchester", "Nashua", "Concord", "Derry", "Portsmouth"]},
            "New Jersey": {"rate": 0.0625, "cities": ["Newark", "Jersey City", "Paterson", "Elizabeth", "Trenton", "Clifton"]},
            "New Mexico": {"rate": 0.0525, "cities": ["Albuquerque", "Las Cruces", "Rio Rancho", "Santa Fe", "Roswell"]},
            "New York": {"rate": 0.04, "cities": ["New York City", "Buffalo", "Rochester", "Syracuse", "Yonkers", "Albany"]},
            "North Carolina": {"rate": 0.04, "cities": ["Charlotte", "Raleigh", "Greensboro", "Durham", "Winston-Salem", "Fayetteville"]},
            "North Dakota": {"rate": 0.05, "cities": ["Bismarck", "Fargo", "Grand Forks", "Minot", "Williston"]},
            "Ohio": {"rate": 0.0575, "cities": ["Columbus", "Cleveland", "Cincinnati", "Toledo", "Akron", "Dayton"]},
            "Oklahoma": {"rate": 0.045, "cities": ["Oklahoma City", "Tulsa", "Norman", "Broken Arrow", "Edmond", "Lawton"]},
            "Oregon": {"rate": 0.00, "cities": ["Portland", "Eugene", "Salem", "Gresham", "Hillsboro"]},
            "Pennsylvania": {"rate": 0.06, "cities": ["Philadelphia", "Pittsburgh", "Allentown", "Erie", "Reading", "Scranton"]},
            "Rhode Island": {"rate": 0.07, "cities": ["Providence", "Warwick", "Cranston", "Pawtucket", "Newport"]},
            "South Carolina": {"rate": 0.05, "cities": ["Charleston", "Columbia", "Greenville", "Spartanburg", "Myrtle Beach"]},
            "South Dakota": {"rate": 0.045, "cities": ["Sioux Falls", "Rapid City", "Aberdeen", "Brookings", "Watertown"]},
            "Tennessee": {"rate": 0.07, "cities": ["Columbia", "Nashville", "Memphis", "Knoxville", "Chattanooga", "Clarksville"]},
            "Texas": {"rate": 0.0625, "cities": ["Mesquite", "Houston", "Dallas", "Austin", "San Antonio", "Fort Worth", "El Paso"]},
            "Utah": {"rate": 0.0595, "cities": ["Salt Lake City", "Provo", "West Valley City", "Lehi", "Ogden", "Orem"]},
            "Vermont": {"rate": 0.06, "cities": ["Burlington", "Montpelier", "Rutland", "Barre", "South Burlington"]},
            "Virginia": {"rate": 0.0575, "cities": ["Virginia Beach", "Richmond", "Arlington", "Alexandria", "Roanoke", "Norfolk"]},
            "Washington": {"rate": 0.065, "cities": ["Seattle", "Tacoma", "Vancouver", "Bellevue", "Kent", "Everett"]},
            "West Virginia": {"rate": 0.06, "cities": ["Charleston", "Huntington", "Parkersburg", "Morgantown", "Wheeling"]},
            "Wisconsin": {"rate": 0.05, "cities": ["Milwaukee", "Madison", "Green Bay", "Kenosha", "Racine", "Appleton"]},
            "Wyoming": {"rate": 0.04, "cities": ["Cheyenne", "Casper", "Laramie", "Gillette", "Rock Springs"]}
        };

        const products = ['Full Tang', '8" Rat', '6" Rat', '8" Stag', '6" Stag', 'Grooved', 'Folders', 'Clipped Folder'];
        const sheets = ['wetumpka', 'mesquite', 'trussville', 'columbia', 'hattiesburg'];
        let salesSheetCount = 0;
        let aaronSalesSheetCount = 0;

        // Initialize state and city dropdowns
        function initializeDropdowns() {
            sheets.forEach(sheet => {
                const stateSelect = document.getElementById(`state-select-${sheet}`);
                if (stateSelect) {
                    Object.keys(TAX_DATABASE).forEach(state => {
                        const option = document.createElement('option');
                        option.value = state;
                        option.textContent = state;
                        stateSelect.appendChild(option);
                    });
                }
            });
        }

        // Update city dropdown based on selected state
        function updateCityDropdown(sheet) {
            const stateSelect = document.getElementById(`state-select-${sheet}`);
            const citySelect = document.getElementById(`city-select-${sheet}`);
            const state = stateSelect.value;

            citySelect.innerHTML = '<option value="">-- Select City --</option>';

            if (state && TAX_DATABASE[state]) {
                TAX_DATABASE[state].cities.forEach(city => {
                    const option = document.createElement('option');
                    option.value = city;
                    option.textContent = city;
                    citySelect.appendChild(option);
                });
            }
        }

        // Calculate and update tax
        function updateTaxCalculation(sheet) {
            const taxCheckbox = document.getElementById(`tax-required-${sheet}`);
            const stateSelect = document.getElementById(`state-select-${sheet}`);
            const taxRow = document.getElementById(`tax-row-${sheet}`);
            const taxSummary = document.querySelector(`.tax-summary[data-sheet="${sheet}"]`);

            if (!taxCheckbox.checked) {
                taxRow.style.display = 'none';
                return;
            }

            const state = stateSelect.value;
            if (!state || !TAX_DATABASE[state]) {
                taxRow.style.display = 'none';
                return;
            }

            const taxRate = TAX_DATABASE[state].rate;
            const subtotal = parseFloat(document.querySelector(`.revenue-total[data-sheet="${sheet}"]`).value) || 0;
            const taxAmount = subtotal * taxRate;
            const total = subtotal + taxAmount;

            taxSummary.value = `$${subtotal.toFixed(2)} | $${taxAmount.toFixed(2)} | $${total.toFixed(2)}`;
            taxRow.style.display = 'table-row';
        }

        // Update revenue calculation
        function updateRevenue(sheet) {
            let totalRevenue = 0;

            for (let i = 0; i < 8; i++) {
                const unitsSold = parseInt(document.querySelector(`.units-sold[data-sheet="${sheet}"][data-row="${i}"]`)?.value) || 0;
                const price = parseFloat(document.querySelector(`.pop-price[data-product="${i}"]`)?.value) || parseFloat(document.querySelector(`.aaron-price[data-product="${i}"]`)?.value) || 0;
                totalRevenue += unitsSold * price;
            }

            const revenueEl = document.querySelector(`.revenue-total[data-sheet="${sheet}"]`);
            if (revenueEl) {
                revenueEl.value = totalRevenue.toFixed(2);
            }

            updateTaxCalculation(sheet);
        }

        // Tab navigation
        function openTab(evt, tabName) {
            document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            document.getElementById(tabName).classList.add('active');
            if (evt && evt.currentTarget) {
                evt.currentTarget.classList.add('active');
            }
            updateAllInventories();
        }

        // Modals
        function openNewSalesSheetModal() {
            document.getElementById('newSalesModal').classList.add('active');
        }

        function closeNewSalesSheetModal() {
            document.getElementById('newSalesModal').classList.remove('active');
        }

        function openNewAaronSalesSheetModal() {
            document.getElementById('newAaronSalesModal').classList.add('active');
        }

        function closeNewAaronSalesSheetModal() {
            document.getElementById('newAaronSalesModal').classList.remove('active');
        }

        function createNewSalesSheet() {
            const name = document.getElementById('sheetName').value;
            const date = document.getElementById('sheetDate').value;
            const sheetId = `custom-pop-sheet-${salesSheetCount}`;

            const newTab = document.createElement('div');
            newTab.id = sheetId;
            newTab.className = 'tab-content';
            newTab.innerHTML = `
                <div class="tab-section">
                    <h2>${name} - ${date}</h2>
                    <div class="tax-controls">
                        <div class="tax-control-group">
                            <input type="checkbox" id="tax-required-${sheetId}" class="tax-checkbox" data-sheet="${sheetId}">
                            <label for="tax-required-${sheetId}">Sales Tax Required?</label>
                        </div>
                        <div class="tax-control-group">
                            <label for="state-select-${sheetId}">State:</label>
                            <select id="state-select-${sheetId}" class="state-select" data-sheet="${sheetId}" onchange="updateCityDropdown('${sheetId}')">
                                <option value="">-- Select State --</option>
                            </select>
                        </div>
                        <div class="tax-control-group">
                            <label for="city-select-${sheetId}">City:</label>
                            <select id="city-select-${sheetId}" class="city-select" data-sheet="${sheetId}" onchange="updateTaxCalculation('${sheetId}')">
                                <option value="">-- Select City --</option>
                            </select>
                        </div>
                    </div>
                    <label style="display:inline-flex;align-items:center;gap:6px;margin-bottom:10px;font-size:13px;">
                        <input type="radio" name="pop-active-sheet" class="pop-active-radio" value="${sheetId}">
                        Use this sheet as Pop's active show
                    </label>
                    <table>
                        <thead>
                            <tr>
                                <th>Product Name</th>
                                <th>Units Brought</th>
                                <th>Units Sold</th>
                                <th>Units Left</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${products.map((p, i) => `
                                <tr>
                                    <td>${p}</td>
                                    <td><input type="number" class="units-brought" data-sheet="${sheetId}" data-row="${i}"></td>
                                    <td><input type="number" class="units-sold" data-sheet="${sheetId}" data-row="${i}" readonly></td>
                                    <td><input type="number" class="units-left" data-sheet="${sheetId}" data-row="${i}"></td>
                                </tr>
                            `).join('')}
                            <tr class="revenue-row">
                                <td><strong>TOTAL REVENUE</strong></td>
                                <td colspan="2"><input type="number" class="revenue-total" data-sheet="${sheetId}" readonly></td>
                                <td></td>
                            </tr>
                            <tr class="tax-summary-row" id="tax-row-${sheetId}" style="display:none;">
                                <td><strong>Subtotal | Tax | Total</strong></td>
                                <td colspan="2"><input type="text" class="tax-summary" data-sheet="${sheetId}" readonly style="font-weight: bold;"></td>
                                <td></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            `;
            document.querySelector('.container').appendChild(newTab);

            const newBtn = document.createElement('button');
            newBtn.className = 'tab-btn';
            newBtn.textContent = `üìç ${name}`;
            newBtn.onclick = (e) => openTab(e, sheetId);
            document.querySelector('.nav-tabs').appendChild(newBtn);

            const link = document.createElement('button');
            link.className = 'nav-link';
            link.textContent = `üìç ${name}`;
            link.onclick = (e) => openTab(e, sheetId);
            document.getElementById('dynamic-sales-links').appendChild(link);

            // Initialize dropdowns for new sheet
            const stateSelect = document.getElementById(`state-select-${sheetId}`);
            Object.keys(TAX_DATABASE).forEach(state => {
                const option = document.createElement('option');
                option.value = state;
                option.textContent = state;
                stateSelect.appendChild(option);
            });

            attachEventListeners();
            closeNewSalesSheetModal();
            document.getElementById('sheetName').value = '';
            document.getElementById('sheetDate').value = '';
            salesSheetCount++;
        }

        function createNewAaronSalesSheet() {
            const name = document.getElementById('aaronSheetName').value;
            const date = document.getElementById('aaronSheetDate').value;
            const sheetId = `custom-aaron-sheet-${aaronSalesSheetCount}`;

            const newTab = document.createElement('div');
            newTab.id = sheetId;
            newTab.className = 'tab-content';
            newTab.innerHTML = `
                <div class="tab-section">
                    <h2>${name} - ${date}</h2>
                    <div class="tax-controls">
                        <div class="tax-control-group">
                            <input type="checkbox" id="tax-required-${sheetId}" class="tax-checkbox" data-sheet="${sheetId}">
                            <label for="tax-required-${sheetId}">Sales Tax Required?</label>
                        </div>
                        <div class="tax-control-group">
                            <label for="state-select-${sheetId}">State:</label>
                            <select id="state-select-${sheetId}" class="state-select" data-sheet="${sheetId}" onchange="updateCityDropdown('${sheetId}')">
                                <option value="">-- Select State --</option>
                            </select>
                        </div>
                        <div class="tax-control-group">
                            <label for="city-select-${sheetId}">City:</label>
                            <select id="city-select-${sheetId}" class="city-select" data-sheet="${sheetId}" onchange="updateTaxCalculation('${sheetId}')">
                                <option value="">-- Select City --</option>
                            </select>
                        </div>
                    </div>
                    <label style="display:inline-flex;align-items:center;gap:6px;margin-bottom:10px;font-size:13px;">
                        <input type="radio" name="aaron-active-sheet" class="aaron-active-radio" value="${sheetId}">
                        Use this sheet as Aaron's active show
                    </label>
                    <table>
                        <thead>
                            <tr>
                                <th>Product Name</th>
                                <th>Units Brought</th>
                                <th>Units Sold</th>
                                <th>Units Left</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${products.map((p, i) => `
                                <tr>
                                    <td>${p}</td>
                                    <td><input type="number" class="units-brought" data-sheet="${sheetId}" data-row="${i}"></td>
                                    <td><input type="number" class="units-sold" data-sheet="${sheetId}" data-row="${i}" readonly></td>
                                    <td><input type="number" class="units-left" data-sheet="${sheetId}" data-row="${i}"></td>
                                </tr>
                            `).join('')}
                            <tr class="revenue-row">
                                <td><strong>TOTAL REVENUE</strong></td>
                                <td colspan="2"><input type="number" class="revenue-total" data-sheet="${sheetId}" readonly></td>
                                <td></td>
                            </tr>
                            <tr class="tax-summary-row" id="tax-row-${sheetId}" style="display:none;">
                                <td><strong>Subtotal | Tax | Total</strong></td>
                                <td colspan="2"><input type="text" class="tax-summary" data-sheet="${sheetId}" readonly style="font-weight: bold;"></td>
                                <td></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            `;
            document.querySelector('.container').appendChild(newTab);

            const newBtn = document.createElement('button');
            newBtn.className = 'tab-btn';
            newBtn.textContent = `üìç ${name}`;
            newBtn.onclick = (e) => openTab(e, sheetId);
            document.querySelector('.nav-tabs').appendChild(newBtn);

            const link = document.createElement('button');
            link.className = 'nav-link';
            link.textContent = `üìç ${name}`;
            link.onclick = (e) => openTab(e, sheetId);
            document.getElementById('dynamic-aaron-sales-links').appendChild(link);

            // Initialize dropdowns for new sheet
            const stateSelect = document.getElementById(`state-select-${sheetId}`);
            Object.keys(TAX_DATABASE).forEach(state => {
                const option = document.createElement('option');
                option.value = state;
                option.textContent = state;
                stateSelect.appendChild(option);
            });

            attachEventListeners();
            closeNewAaronSalesSheetModal();
            document.getElementById('aaronSheetName').value = '';
            document.getElementById('aaronSheetDate').value = '';
            aaronSalesSheetCount++;
        }

        // Update Pop Inventory
        function updatePopInventory() {
            const activeSheet = document.querySelector('input[name="pop-active-sheet"]:checked')?.value;
            if (!activeSheet) return;

            for (let i = 0; i < 8; i++) {
                const brought = parseInt(document.querySelector(`.units-brought[data-sheet="${activeSheet}"][data-row="${i}"]`)?.value) || 0;
                const left = parseInt(document.querySelector(`.units-left[data-sheet="${activeSheet}"][data-row="${i}"]`)?.value) || 0;
                const sold = Math.max(0, brought - left);

                document.querySelector(`.units-sold[data-sheet="${activeSheet}"][data-row="${i}"]`).value = sold;

                const storage = parseInt(document.querySelector(`.pop-storage[data-product="${i}"]`)?.value) || 0;
                const totalSold = calculateTotalSoldPop(i);
                const currentStock = storage + brought - totalSold;

                document.querySelector(`.pop-show[data-product="${i}"]`).value = brought;
                document.querySelector(`.pop-post-show[data-product="${i}"]`).value = left;
                document.querySelector(`.pop-current-stock[data-product="${i}"]`).value = Math.max(0, currentStock);
            }

            const total = Array.from(document.querySelectorAll('.pop-current-stock')).reduce((sum, inp) => sum + (parseInt(inp.value) || 0), 0);
            document.getElementById('pop-total-on-hand').value = total;

            updateRevenue(activeSheet);
        }

        // Update Aaron Inventory
        function updateAaronInventory() {
            const activeSheet = document.querySelector('input[name="aaron-active-sheet"]:checked')?.value;
            if (!activeSheet) return;

            for (let i = 0; i < 8; i++) {
                const brought = parseInt(document.querySelector(`.units-brought[data-sheet="${activeSheet}"][data-row="${i}"]`)?.value) || 0;
                const left = parseInt(document.querySelector(`.units-left[data-sheet="${activeSheet}"][data-row="${i}"]`)?.value) || 0;
                const sold = Math.max(0, brought - left);

                document.querySelector(`.units-sold[data-sheet="${activeSheet}"][data-row="${i}"]`).value = sold;

                const storage = parseInt(document.querySelector(`.aaron-storage[data-product="${i}"]`)?.value) || 0;
                const totalSold = calculateTotalSoldAaron(i);
                const currentStock = storage + brought - totalSold;

                document.querySelector(`.aaron-show[data-product="${i}"]`).value = brought;
                document.querySelector(`.aaron-post-show[data-product="${i}"]`).value = left;
                document.querySelector(`.aaron-current-stock[data-product="${i}"]`).value = Math.max(0, currentStock);
            }

            const total = Array.from(document.querySelectorAll('.aaron-current-stock')).reduce((sum, inp) => sum + (parseInt(inp.value) || 0), 0);
            document.getElementById('aaron-total-on-hand').value = total;

            updateRevenue(activeSheet);
        }

        function calculateTotalSoldPop(productIndex) {
            let total = 0;
            sheets.forEach(sheet => {
                total += parseInt(document.querySelector(`.units-sold[data-sheet="${sheet}"][data-row="${productIndex}"]`)?.value) || 0;
            });
            return total;
        }

        function calculateTotalSoldAaron(productIndex) {
            let total = 0;
            document.querySelectorAll(`.units-sold[data-row="${productIndex}"]`).forEach(inp => {
                if (inp.dataset.sheet.includes('aaron')) {
                    total += parseInt(inp.value) || 0;
                }
            });
            return total;
        }

        // Update Master Inventory
        function updateMasterInventory() {
            for (let i = 0; i < 8; i++) {
                const popVal = parseInt(document.querySelector(`.pop-current-stock[data-product="${i}"]`)?.value) || 0;
                const aaronVal = parseInt(document.querySelector(`.aaron-current-stock[data-product="${i}"]`)?.value) || 0;
                const combined = popVal + aaronVal;

                document.querySelector(`.master-pop-stock[data-product="${i}"]`).value = popVal;
                document.querySelector(`.master-aaron-stock[data-product="${i}"]`).value = aaronVal;
                document.querySelector(`.master-combined[data-product="${i}"]`).value = combined;
            }

            let popTotal = 0, aaronTotal = 0, grandTotal = 0;
            document.querySelectorAll('.master-pop-stock').forEach(inp => popTotal += parseInt(inp.value) || 0);
            document.querySelectorAll('.master-aaron-stock').forEach(inp => aaronTotal += parseInt(inp.value) || 0);
            document.querySelectorAll('.master-combined').forEach(inp => grandTotal += parseInt(inp.value) || 0);

            document.getElementById('master-pop-total').value = popTotal;
            document.getElementById('master-aaron-total').value = aaronTotal;
            document.getElementById('master-grand-total').value = grandTotal;
        }

        function updateAllInventories() {
            updatePopInventory();
            updateAaronInventory();
            updateMasterInventory();
            updateChartsData();
        }

        function updateChartsData() {
            const unitsSold = [];
            products.forEach((_, i) => {
                let total = 0;
                document.querySelectorAll(`.units-sold[data-row="${i}"]`).forEach(inp => {
                    total += parseInt(inp.value) || 0;
                });
                unitsSold.push(total);
            });

            if (window.pieChart) {
                window.pieChart.data.datasets[0].data = unitsSold;
                window.pieChart.update();
            }

            if (window.barChart) {
                window.barChart.data.datasets[0].data = unitsSold;
                window.barChart.update();
            }
        }

        function refreshSalesCharts() {
            updateChartsData();
        }

        function initCharts() {
            const unitsSold = Array(8).fill(0);

            const pieCtx = document.getElementById('salesPieChart')?.getContext('2d');
            if (pieCtx) {
                window.pieChart = new Chart(pieCtx, {
                    type: 'pie',
                    data: {
                        labels: products,
                        datasets: [{
                            data: unitsSold,
                            backgroundColor: ['#667eea', '#764ba2', '#f093fb', '#4facfe', '#00f2fe', '#43e97b', '#fa709a', '#fee140']
                        }]
                    },
                    options: { responsive: true, plugins: { legend: { position: 'bottom' } } }
                });
            }

            const barCtx = document.getElementById('salesBarChart')?.getContext('2d');
            if (barCtx) {
                window.barChart = new Chart(barCtx, {
                    type: 'bar',
                    data: {
                        labels: products,
                        datasets: [{ label: 'Units Sold', data: unitsSold, backgroundColor: '#667eea' }]
                    },
                    options: { responsive: true, plugins: { legend: { display: true } }, scales: { y: { beginAtZero: true } } }
                });
            }
        }

        function attachEventListeners() {
            document.querySelectorAll('input[data-product], input[data-sheet], input.tax-checkbox').forEach(inp => {
                inp.addEventListener('input', () => {
                    const sheet = inp.dataset.sheet;
                    if (sheet) {
                        if (inp.classList.contains('tax-checkbox')) {
                            updateTaxCalculation(sheet);
                        } else {
                            updateRevenue(sheet);
                            updateAllInventories();
                        }
                    } else {
                        updateAllInventories();
                    }
                });
                inp.addEventListener('change', () => {
                    const sheet = inp.dataset.sheet;
                    if (sheet) {
                        updateAllInventories();
                    } else {
                        updateAllInventories();
                    }
                });
            });

            document.querySelectorAll('input[name="pop-active-sheet"], input[name="aaron-active-sheet"]').forEach(radio => {
                radio.addEventListener('change', updateAllInventories);
            });
        }

        function saveAppData() {
            const data = {
                popInventory: {},
                aaronInventory: {},
                salesSheets: {},
                taxSettings: {}
            };

            for (let i = 0; i < 8; i++) {
                data.popInventory[i] = {
                    price: document.querySelector(`.pop-price[data-product="${i}"]`)?.value || '',
                    storage: document.querySelector(`.pop-storage[data-product="${i}"]`)?.value || ''
                };
                data.aaronInventory[i] = {
                    price: document.querySelector(`.aaron-price[data-product="${i}"]`)?.value || '',
                    storage: document.querySelector(`.aaron-storage[data-product="${i}"]`)?.value || ''
                };
            }

            document.querySelectorAll('[data-sheet]').forEach(inp => {
                const sheetId = inp.dataset.sheet;
                const row = inp.dataset.row;
                if (!data.salesSheets[sheetId]) data.salesSheets[sheetId] = {};
                if (!data.salesSheets[sheetId][row]) data.salesSheets[sheetId][row] = {};

                if (inp.classList.contains('units-brought')) {
                    data.salesSheets[sheetId][row].brought = inp.value;
                } else if (inp.classList.contains('units-left')) {
                    data.salesSheets[sheetId][row].left = inp.value;
                }
            });

            document.querySelectorAll('.tax-checkbox').forEach(checkbox => {
                const sheet = checkbox.dataset.sheet;
                const state = document.getElementById(`state-select-${sheet}`)?.value || '';
                const city = document.getElementById(`city-select-${sheet}`)?.value || '';
                data.taxSettings[sheet] = {
                    required: checkbox.checked,
                    state: state,
                    city: city
                };
            });

            localStorage.setItem('knifeInventoryData', JSON.stringify(data));
            alert('Data saved successfully!');
        }

        function loadAppData() {
            const saved = localStorage.getItem('knifeInventoryData');
            if (!saved) return;

            const data = JSON.parse(saved);

            Object.keys(data.popInventory || {}).forEach(i => {
                const priceEl = document.querySelector(`.pop-price[data-product="${i}"]`);
                const storageEl = document.querySelector(`.pop-storage[data-product="${i}"]`);
                if (priceEl) priceEl.value = data.popInventory[i].price;
                if (storageEl) storageEl.value = data.popInventory[i].storage;
            });

            Object.keys(data.aaronInventory || {}).forEach(i => {
                const priceEl = document.querySelector(`.aaron-price[data-product="${i}"]`);
                const storageEl = document.querySelector(`.aaron-storage[data-product="${i}"]`);
                if (priceEl) priceEl.value = data.aaronInventory[i].price;
                if (storageEl) storageEl.value = data.aaronInventory[i].storage;
            });

            Object.keys(data.salesSheets || {}).forEach(sheetId => {
                Object.keys(data.salesSheets[sheetId]).forEach(row => {
                    const brought = document.querySelector(`.units-brought[data-sheet="${sheetId}"][data-row="${row}"]`);
                    const left = document.querySelector(`.units-left[data-sheet="${sheetId}"][data-row="${row}"]`);
                    if (brought) brought.value = data.salesSheets[sheetId][row].brought || '';
                    if (left) left.value = data.salesSheets[sheetId][row].left || '';
                });
            });

            Object.keys(data.taxSettings || {}).forEach(sheet => {
                const taxCheckbox = document.getElementById(`tax-required-${sheet}`);
                const stateSelect = document.getElementById(`state-select-${sheet}`);
                const citySelect = document.getElementById(`city-select-${sheet}`);

                if (taxCheckbox) taxCheckbox.checked = data.taxSettings[sheet].required;
                if (stateSelect) stateSelect.value = data.taxSettings[sheet].state;
                if (citySelect) {
                    updateCityDropdown(sheet);
                    citySelect.value = data.taxSettings[sheet].city;
                }
            });

            updateAllInventories();
        }

        window.addEventListener('load', () => {
            initializeDropdowns();
            attachEventListeners();
            initCharts();
            loadAppData();
            updateAllInventories();
        });
    </script>
</body>
</html>
